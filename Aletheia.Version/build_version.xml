<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir="." default="version" name="Aletheia.Version.version">
	<property name="version.file" value="bin/aletheia/version/version.txt"/>	
    <target name="version" depends="git.revision">
    	<echo file="${version.file}" message="${repository.version}"/>
    </target>
    <target name="clean_version">
        <delete file="${version.file}"/>
    </target>
	
	<available file="../.git" type="dir" property="git.present"/>

	<target name="git.revision" description="Store git revision in ${repository.version}" if="git.present">
	    <exec executable="git" outputproperty="git.revision" failifexecutionfails="false" errorproperty="">
	        <arg value="describe"/>
	        <arg value="--tags"/>
	        <arg value="--always"/>
	        <arg value="--dirty"/>
	    </exec>
	    <condition property="repository.version" value="${git.revision}" else="unknown">
	        <and>
	            <isset property="git.revision"/>
	            <length string="${git.revision}" trim="yes" length="0" when="greater"/>
	        </and>
	    </condition>
	</target>
	
</project>
